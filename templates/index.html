<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Amicus IA - Detector de Emociones</title>
    <link rel="stylesheet" href="../static/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <nav class="nav">
            <div class="nav-brand">
                <i class="fas fa-heart pulse"></i>
                <span>Amicus IA</span>
            </div>
            <div class="nav-links">
                <a href="#home" class="nav-link active">Inicio</a>
                <a href="#detector" class="nav-link">Detector</a>
                <a href="#contact" class="nav-link">Contacto</a>
            </div>
        </nav>
    </header>

    <!-- Hero Section -->
    <section id="home" class="hero">
        <div class="hero-background">
            <div class="floating-shapes">
                <div class="shape shape-1"></div>
                <div class="shape shape-2"></div>
                <div class="shape shape-3"></div>
                <div class="shape shape-4"></div>
            </div>
        </div>
        
        <div class="hero-content">
            <div class="hero-text">
                <h1 class="hero-title">
                    Descubre la <span class="gradient-text">Emoción</span> 
                    de tu Mensaje
                </h1>
                <p class="hero-subtitle">
                    Nuestro sistema utiliza inteligencia artificial para analizar 
                    y comprender las emociones en tus mensajes en inglés dentro del cuadro de texto.
                </p>
                <div class="hero-stats">
                    <div class="stat">
                        <span class="stat-number">72%</span>
                        <span class="stat-label">Precisión</span>
                    </div>
                    <div class="stat">
                        <span class="stat-number">30+</span>
                        <span class="stat-label">Emociones detectables</span>
                    </div>
                </div>
                <div class="hero-buttons">
                    <button class="btn btn-primary" onclick="scrollToSection('detector')">
                        <i class="fas fa-brain"></i>
                        Probar Detector
                    </button>
                    <button class="btn btn-secondary" onclick="toggleChat()">
                        <i class="fas fa-comments"></i>
                        Chatbot Amicus IA
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Detector Section -->
    <section id="detector" class="chatbot-section">
        <div class="container">
            <div class="chatbot-header">
                <h2 class="section-title">Detector de Emociones</h2>
                <p class="section-subtitle">
                    Escribe cualquier mensaje y descubre qué emoción transmite.
                </p>
            </div>
            
            <div class="detector-container">
                <div class="detector-interface">
                    <div class="detector-header">
                        <div class="bot-avatar">
                            <i class="fas fa-brain"></i>
                        </div>
                        <div class="bot-info">
                            <h3>Detector de Emociones</h3>
                            <span class="status online">Listo para analizar</span>
                        </div>
                        <div class="accuracy-badge">
                            <span>72% precisión</span>
                        </div>
                    </div>
                    
                    <div class="emotion-display" id="emotionDisplay">
                        <div class="emotion-result" id="emotionResult">
                            <h4>Escribe algo para empezar</h4>
                            <p>El detector analizará tu mensaje</p>
                        </div>
                    </div>
                    
                    <div class="emotion-input">
                        <div class="input-container">
                            <textarea 
                                id="emotionTextarea" 
                                placeholder="Escribe aquí tu mensaje para detectar la emoción..." 
                                maxlength="500"
                                rows="3"
                            ></textarea>
                            <div class="input-actions">
                                <button class="clear-btn" id="clearBtn" title="Limpiar">
                                    <i class="fas fa-times"></i>
                                </button>
                                <button class="detect-btn" id="detectBtn">
                                    <i class="fas fa-search"></i>
                                    Detectar
                                </button>
                            </div>
                        </div>
                        <div class="character-count">
                            <span id="charCount">0</span>/500
                        </div>
                    </div>
                </div>
                
                <div class="detector-info">
                    <div class="info-card">
                        <h4><i class="fas fa-heart"></i> Emociones detectables</h4>
                        <div class="emotions-list">
                            <ul>
                                <li>Alegre (joyful)</li>
                                <li>Triste (sad)</li>
                                <li>Enojado (angry)</li>
                                <li>Ansioso (anxious)</li>
                                <li>Asustado (afraid)</li>
                                <li>Sorprendido (surprised)</li>
                                <li>Confundido (confused)</li>
                                <li>Disgustado (disgusted)</li>
                                <li>Culpable (guilty)</li>
                                <li>Orgulloso (proud)</li>
                                <li>Esperanzado (hopeful)</li>
                                <li>Decepcionado (disappointed)</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="info-card">
                        <h4><i class="fas fa-chart-line"></i> Cómo funciona</h4>
                        <ol class="how-it-works">
                            <li>Escribe tu mensaje en el cuadro de texto</li>
                            <li>El sistema analizará el contenido</li>
                            <li>Obtendrás la emoción detectada</li>
                            <li>Y el nivel de confianza del análisis</li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Chatbot Flotante -->
    <div class="chatbot" onclick="toggleChat()" title="Chatbot Amicus IA - Asistente Emocional">
        <i class="fas fa-comments chatbot-icon"></i>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-brand">
                    <div class="brand-logo">
                        <i class="fas fa-heart"></i>
                        <span>Amicus IA</span>
                    </div>
                    <p>Tecnología para el bienestar emocional</p>
                </div>
                
                <div class="footer-links">
                    <div class="link-group">
                        <h4>Navegación</h4>
                        <a href="#home">Inicio</a>
                        <a href="#detector">Detector</a>
                    </div>
                    
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2025 Amicus IA. Todos los derechos reservados.</p>
            </div>
        </div>
    </footer>

    <!-- Scripts de Botpress -->
    <script src="https://cdn.botpress.cloud/webchat/v3.2/inject.js" defer></script>
    <script src="https://files.bpcontent.cloud/2025/08/01/21/20250801214217-RQJKML86.js" defer></script>

    <script>
        // Función para scroll suave
        function scrollToSection(sectionId) {
            document.getElementById(sectionId).scrollIntoView({
                behavior: 'smooth'
            });
        }

        // Función para detectar emociones
        async function detectEmotion(text) {
            if (!text.trim()) {
                document.getElementById('emotionResult').innerHTML = `
                    <h4>Escribe algo para empezar</h4>
                    <p>El detector analizará tu mensaje</p>
                `;
                return;
            }
            
            try {
                // Mostrar estado de carga
                document.getElementById('emotionResult').innerHTML = '<h4>Analizando...</h4>';
                
                const response = await fetch('http://localhost:5000/detect-emotion', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ text: text })
                });
                
                if (!response.ok) {
                    throw new Error('Error en el servidor');
                }
                
                const data = await response.json();
                
                // Mostrar resultado
                document.getElementById('emotionResult').innerHTML = `
                    <h4>Resultado del análisis:</h4>
                    <p><strong>Emoción:</strong> ${data.emotion} ${data.emoji || ''}</p>
                    <p><strong>Confianza:</strong> ${Math.round(data.confidence * 100)}%</p>
                `;
                
            } catch (error) {
                document.getElementById('emotionResult').innerHTML = `
                    <h4>Error de conexión</h4>
                    <p>Por favor verifica que el servidor esté funcionando</p>
                    <p><small>${error.message}</small></p>
                `;
            }
        }

        // Configuración de eventos del detector
        document.addEventListener('DOMContentLoaded', function() {
            const textarea = document.getElementById('emotionTextarea');
            const charCount = document.getElementById('charCount');
            
            // Contador de caracteres
            textarea.addEventListener('input', function() {
                charCount.textContent = this.value.length;
            });
            
            // Botón de detección
            document.getElementById('detectBtn').addEventListener('click', function(e) {
                e.preventDefault();
                detectEmotion(textarea.value.trim());
            });
            
            // Botón de limpiar
            document.getElementById('clearBtn').addEventListener('click', function(e) {
                e.preventDefault();
                textarea.value = '';
                charCount.textContent = '0';
                document.getElementById('emotionResult').innerHTML = `
                    <h4>Escribe algo para empezar</h4>
                    <p>El detector analizará tu mensaje</p>
                `;
            });
        });

        // Inicialización del chatbot Amicus IA
        window.addEventListener('load', function() {
            if (window.botpressWebChat) {
                window.botpressWebChat.init({
                    host: 'https://cdn.botpress.cloud/webchat/v3.2/shareable.html?configUrl=https://files.bpcontent.cloud/2025/08/01/21/20250801214218-8J9YVTRC.json',
                    botId: '70d07b3e-717e-4496-a774-26d4137b489b',
                    container: '#botpress-chatbot-container',
                    hideWidget: true,
                    botName: 'Amicus IA'
                });
                console.log('✅ Chatbot Amicus IA inicializado correctamente');
            } else {
                console.error('❌ Error: Botpress WebChat no está disponible');
            }
        });

        // Función para abrir/cerrar el chat
        function toggleChat() {
            if (window.botpressWebChat) {
                window.botpressWebChat.sendEvent({ 
                    type: 'show' 
                });
                window.botpressWebChat.sendEvent({ 
                    type: 'toggle' 
                });
            } else {
                console.error('❌ Chatbot no disponible');
                alert('El chatbot no está disponible en este momento. Por favor, intenta más tarde.');
            }
        }

        // Navegación activa
        document.addEventListener('scroll', function() {
            const sections = ['home', 'features', 'detector', 'contact'];
            const navLinks = document.querySelectorAll('.nav-link');
            
            let currentSection = '';
            sections.forEach(section => {
                const element = document.getElementById(section);
                if (element) {
                    const rect = element.getBoundingClientRect();
                    if (rect.top <= 100 && rect.bottom >= 100) {
                        currentSection = section;
                    }
                }
            });
            
            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href').substring(1) === currentSection) {
                    link.classList.add('active');
                }
            });
        });
    </script>
</body>
</html>